---
import type { Lang } from '../i18n/index';
import type { ImageMetadata } from 'astro';
import { techContent } from '../content/data/tech';
import HeroSection from '../components/HeroSection.astro';
import FeatureIcon from '../components/FeatureIcon.astro';
import IconList from '../components/IconList.astro';

// SVG Icons
import siteBookingIcon from '../assets/icons/Site-booking.svg';
import materialsIcon from '../assets/icons/Materials-lCA.svg';
import wasteIcon from '../assets/icons/Waste-Re-sourses.svg';
import sensorsIcon from '../assets/icons/Sensors-AI-alert-engine.svg';
import integrationsIcon from '../assets/icons/Integrations-partners.svg';
import dashboardsIcon from '../assets/icons/Data-Dashboards.svg';

// Images
import dashboardImg from '../assets/images/Operations-dashboard-anonymiseret.png';

interface Props {
  lang: Lang;
}

const { lang } = Astro.props;
const c = techContent[lang];

const iconMap: Record<string, ImageMetadata> = {
  sitebooking: siteBookingIcon,
  materials: materialsIcon,
  waste: wasteIcon,
  sensors: sensorsIcon,
  integrations: integrationsIcon,
  dashboards: dashboardsIcon,
};

type SectionKey = 'sitebooking' | 'materials' | 'waste' | 'sensors' | 'integrations' | 'dashboards';

const sections: SectionKey[] = ['sitebooking', 'integrations', 'materials', 'waste', 'sensors', 'dashboards'];
---

<!-- 1. Hero Section -->
<HeroSection
  title={c.hero.title}
  subtitle={c.hero.subtitle}
/>

<!-- 2. Feature Icon Grid -->
<section class="max-w-[1528px] mx-auto" style="padding: 128px 20px;">
  <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-8">
    {c.features.map((feature) => (
      <a href={`#${feature.key}`} class="hover:opacity-80 transition-opacity">
        <FeatureIcon
          icon={iconMap[feature.key]}
          title={feature.title}
        />
      </a>
    ))}
  </div>
</section>

<!-- 3. Detailed Sections -->
{sections.map((key, index) => {
  const section = c[key];
  const isAccent = index % 2 === 0;
  return (
    <section
      id={key}
      style={`padding: 128px 20px; ${isAccent ? 'background-color: #FFD4A61A;' : ''}`}
    >
      <div class="max-w-[1528px] mx-auto">
        <div class="flex flex-col lg:flex-row gap-16">
          <div class="flex-1 flex flex-col gap-8">
            <h2 class="font-semibold text-sitehub-dark" style="font-size: clamp(26px, 4vw, 64px); line-height: 1.2em;">
              {section.title}
            </h2>
            <div class="flex flex-col gap-4">
              <h3 class="font-semibold text-sitehub-dark" style="font-size: clamp(20px, 2vw, 28px); line-height: 1.3;">
                {section.howTitle}
              </h3>
              <p style="font-size: clamp(18px, 1.5vw, 24px); line-height: 1.5;">
                {section.howText}
              </p>
            </div>
            {key === 'dashboards' && (
              <div class="mt-4">
                <img
                  src={dashboardImg.src}
                  alt="SiteHub Dashboard"
                  width={dashboardImg.width}
                  height={dashboardImg.height}
                  loading="lazy"
                  style="width: 100%; border-radius: 16px; object-fit: cover;"
                />
              </div>
            )}
          </div>
          <div class="flex-1 flex flex-col gap-6">
            <h3 class="font-semibold text-sitehub-dark" style="font-size: clamp(20px, 2vw, 28px); line-height: 1.3;">
              {section.whatTitle}
            </h3>
            <IconList items={section.whatItems} />
          </div>
        </div>
      </div>
    </section>
  );
})}

<style>
  @media (max-width: 1024px) {
    section {
      padding: 64px 20px !important;
    }
  }
  @media (max-width: 767px) {
    section {
      padding: 50px 20px !important;
    }
  }
</style>
